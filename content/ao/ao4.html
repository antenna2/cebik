<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="keywords" content="Modeling">
  <title>AO 04: Antenna Modeling Software: Part 1</title>
  <link rel="stylesheet" href="../styles.css">
</head>
<body>
  <center>
    <h1><img src="../images/qex.gif" align="left" width="150" height="83" border="2" vspace="5" hspace="25"> <img src="../images/w4rnlwwr.gif" align="right" width="99" height="83" border="2" vspace="5" hspace="25"><i>Modeling Software, Part 1</i></h1>
  </center>
  <center>
    <h3>L. B. Cebik, W4RNL</h3>
  </center>
  <center>
    <img src="../images/colorbar.gif" align="middle" width="540" height="4">
  </center>
  <p>A regular question that appears in my e-mail is what antenna-modeling program to buy or use. The question takes many forms, but the nub usually boils down to matching the options offered by one or more particular programs with the modeling needs of the potential user. So let's examine some of the alternatives in the available array of programs, beginning with the calculating cores that underlie the available implementations. In these notes, I shall assume that you are familiar with the basic terms of antenna modeling using round wires and can handle such terms as wire, segment, source, load, etc. If these terms are still a mystery, see the 4-part series, "A Beginner's Guide to Modeling with NEC," <i>QST</i>, November, 2000, through February, 2001.</p>
  <p>We shall discuss only NEC and MININEC modeling software, both of which are readily available in low cost or entry-level implementations. Table 1 provides a list of such software, along with Internet addresses for those who wish further information. The list is not absolutely complete, and it contains two entries that we shall not discuss. Expert MININEC is a proprietary revision of the original MININEC core, while SuperNEC uses a MatLab interface. Since I do not own either program, they will not figure significantly in the discussion. The "feel" of a program is a highly personal facet of modeling software. Therefore, examining the web sites of the program makers is the best route to determining if you will be comfortable using any of the programs. As well, the web sites can provide up-to-date information on features and price. Programmers are continuously adding features to programs, so these notes are technically out-of-date as soon as I write them.</p>
  <h4>1. NEC or MINNINEC</h4>There are two classes of cores that perform the "method of moments" calculations comprising the analysis of an antenna design. For a more complete history of the development of these two strains of cores, see Bob Haviland, W4MB, "Programs for Antenna Analysis by the Method of Moments," The ARRL Antenna Compendium, Vol. 4, pp. 69-73. NEC emerged from main-frame FORTRAN work, while MININEC was developed to work on early desktop computers having very limited memory resources. Both cores have undergone extensive upgrades. For example, re-programming MININEC in one of the Windows-compatible languages has eliminated the early segment restriction on that core. Likewise, newer FORTRAN compilers for PC use have speeded up the runtimes of NEC models.
  <p>MININEC 3.13 is a public domain program. As a result, it has undergone significant modification to overcome some of its initial limitations in addition to removing the upper limit on the number of segments in a model. All of the Windows implementations listed in Table 1 have no upper limit on the number of segments that a model may have. Two older DOS-based programs, AO (or MN) by Brian Beezley, K6STI, and ELNEC, but Roy Lewallen, W7EL, did have limits of about 256 segments. Expert MININEC by EM Scientific employs a different algorithm set from the ones used in the public domain version. As well, "raw" MININEC has a number of inherent limitations that may or may not be relevant to your modeling needs. All versions (with one exception, Antenna Model) use a ground simulation that becomes highly inaccurate if wires with any horizontal component are closer than about 0.2 wavelength above ground. As well all wires must be above ground, with only vertical wires allowed to touch the ground. The unmodified core is also sensitive to wire spacing, and such simple antennas as a folded dipole may give erroneous results. Sharp corners in the antenna geometry can also yield inaccurate results unless the wire segments are very short or the program has introduced a correction feature. Finally, the MININEC core has a frequency offset that becomes larger with increasing frequency. It becomes noticeable in the 10-meter region of the amateur spectrum.</p>
  <p>Unlike NEC cores, which have undergone very limited modification, the MININEC core has seen extensive modification by individual programmers to overcome these limitations. Over a series of benchmark tests where NEC-4 has shown proven accuracy, the various implementations of MININEC show variable results, each according to the modifications introduced and the success of those modifications. I ran all of the MININEC programs available to me through a series of benchmark tests, and only Antenna Model passed them all. (See <a href="../amod/amod51.html">51. Testing the Fringes of Modeling Programs</a> for details of the benchmark comparisons.) This fact does not mean that the other programs are not useful; instead, it means that they must be used within the frequency or structure limits built into them. There are many lower-frequency modeling tasks with relatively simple antennas for which any of the MININEC implementations will work well.</p>
  <p>What MININEC does very well that NEC does far less well is handle wire junctions with different diameters, whether linear or angled. Indeed, the Leeson correction process, which some implementations of NEC include, used MININEC as the standard during its development.</p>
  <p>NEC cores use a quite different set of algorithms. The cores will handle without modification over 10,000 segments, although software vendors may set a segment limit to various versions of the programs they sell. In addition, NEC has a number of additional features, the most prominent of which is the Sommerfeld-Norton (S-N) ground simulation routine. The S-N ground system is highly accurate, even for wires only fractionally above the surface. (Among MININEC implementations, only Antenna Model has grafted the S-N ground calculation system to its core.) The compiled FORTRAN routines used by many implementations are much faster for similarly sized models than most of the MININEC cores. In addition, NEC includes both networks and (lossless) transmission lines as part of the non-radiating accessories to models. In general, NEC cores have become a de facto standard for round-wire antenna modeling. NEC has a number of unique outputs (relative to MININEC), such as near-field analysis, received currents and scattering patterns from both linear and elliptical plane-wave excitation, and mutual coupling between specified wire segments. As well, NEC includes true ground wave analysis that includes near fields and surface waves.</p>
  <center>
    <img src="ao4-1.gif" width="528" height="366" border="2" vspace="5" hspace="9">
  </center>
  <center>
    <img src="ao4-2.gif" width="688" height="343" border="2" vspace="5" hspace="9">
  </center>
  <p>Entry-level programs generally limit the user to the basic wire geometry command. For example, EZNEC (<b>Fig. 1</b> and <b>Fig. 2</b>) and NEC-Win Plus (<b>Fig. 3</b>) limit wire geometries to straight segmented wires.</p>
  <center>
    <img src="ao4-3.gif" width="640" height="460" border="2" vspace="5" hspace="9">
  </center>
  <p>A full NEC core implementation includes a considerable collection of geometry commands that permits the construction of complex antenna and allied structures with minimal input file size. There are commands to create arcs, circles, helices, and catenary wires. Another command permits both length and diameter tapering along a specified wire. There is a command for rotating, replicating, and moving a wire already created. A large rectangular wire-grid structure might take as few as 4 entry lines for a model in the format (but not the detail) shown in <b>Fig. 4</b>. NEC also includes provision for the creation of surface patches.</p>
  <center>
    <img src="ao4-4.gif" width="726" height="516" border="2" vspace="5" hspace="9">
  </center>
  <p>The key limitation to NEC cores is the inability to handle precisely elements having a changing diameter at wire junctions. For linear elements having no loads, transmission lines, or networks, the Leeson correction system has worked very well. (See David B. Leeson, W6QHS, <i>Physical Design of Yagi Antennas</i> (ARRL, 1992), Chapter 8, for details.) However, where loads, lines, or networks are present along the element length or where the element is not linear, these correctives do not apply. Both EZNEC and NEC-Win Plus include the correctives.</p>
  <p>NEC comes in two generally available versions: NEC-2 and NEC-4. (There is a NEC-3 that saw limited distribution.) We shall discuss the differences between these cores, but first, we should pause to look at file formats.</p>
  <h4>2. File Formats</h4>NEC cores require, in unmodified condition, the use of an ASCII file of the sort on the main GNEC screen shown in <b>Fig. 4</b>. (The NEC-Win Pro main screen would be virtually identical.) The model file contains all parameters of the model in terms of the geometry that describes the wires, the modifications to the geometry (such as the specification of element material loading and a source or excitation), and requests for outputs (the RP command in the illustration). The user may create a full model on a text editor as an input to the NEC core. The standard input file extension is .NEC, although any text editor, such as Notepad, will read the file and permit editing.
  <center>
    <img src="ao4-5.gif" width="764" height="390" border="2" vspace="5" hspace="9">
  </center>
  <center>
    <img src="ao4-6.gif" width="359" height="479" border="2" vspace="5" hspace="9">
  </center>
  <p>A number of NEC implementations use proprietary model file formats that are not ASCII. For example, the NEC-Win Plus files (see <b>Fig. 3</b>) use a spreadsheet format. EZNEC, shown in <b>Fig. 1</b> and <b>Fig. 2</b>, uses its own file format (and transfers data to its cores in binary form). Unlike many other programs, EZNEC uses separate screens for the main data and the individual collections of data that describe the wires, loads, sources, ground values, and other constituents of a model. NEC2GO uses a basic file system derived from but not identical to its progenitors, AO and NEC-Wires (<b>Fig. 5</b>). Nevertheless, all three programs--either in all or in advanced versions--include facilities for converting files constructed in their native file formats into a .NEC file. 4NEC2 (<b>Fig. 6</b>), NEC-Win Pro, and GNEC save files in the basic .NEC format. The bottom line is that a file created under one system with a NEC core is convertible into a file to be saved under another system.</p>
  <center>
    <img src="ao4-7.gif" width="768" height="537" border="2" vspace="5" hspace="9">
  </center>
  <center>
    <img src="ao4-8.gif" width="610" height="410" border="2" vspace="5" hspace="9">
  </center>
  <p>One limitation that likely has limited the use of MININEC among antenna modelers is the fact that there is no standard file format.</p>
  <p><b>Fig. 7</b>, <b>Fig. 8</b>, and <b>Fig. 9</b> present the main screens of Antenna Model, NEC4WIN, and MMANA. They suggest--correctly--that each program uses a different file format that is not directly convertible from one program to the next. In addition, the user must plug some model parameters directly into the program, although some implementations attach these parameters to the individual model file. As a result, it is generally the case that the modeler has to re-construct a model from scratch when moving from one program to the next.</p>
  <center>
    <img src="ao4-9.gif" width="800" height="591" border="2" vspace="5" hspace="9">
  </center>
  <center>
    <img src="ao4-10.gif" width="784" height="346" border="2" vspace="5" hspace="9">
  </center>
  <p>MultiNEC, illustrated in <b>Fig. 10</b>, while not a NEC program in itself, can read many formats, including NEC-Win Plus, EZNEC, and the MININEC program, Antenna Model. Multi-NEC is an Excel application that works with the core of an existing modeling program and adds a considerable number of features on both the input and output side of the core.</p>
  <h4>3. NEC2 or NEC-4</h4>
  <p>The relative popularity of NEC as the basic calculating core for round-wire antenna modeling has resulted in the development of a larger body of modeling assistance than is available for MININEC. Perhaps the most notable training aid is the <i>ARRL Antenna Modeling Correspondence Course</i>, which comes with exercise models in EZNEC, NEC-Win Plus, and basic .NEC formats. However, other volumes (such as <i>Basic Antenna Modeling: A Hands-On Tutorial</i> and <i>Intermediate Antenna Modeling: A Hands-On Tutorial</i>) and article series (for example, "Antenna Modeling" that appears monthly in <i>antenneX</i>) are available.</p>
  <p>NEC-2 is the most widely used core and has become a public domain item. It is therefore available worldwide. The basic algorithms for the core treat only the axial currents, a fact that provides some of the core's limitations. It will not register the influence of a boom that intersects element wires at right angles. It requires a set of substitute uniform diameter elements for accurate calculation of linear elements having a changing diameter along their length. Non-radiating loads, transmission lines, and networks are most accurate in regions of an element that have a high and stable current, and such additions to the wire structure become less accurate as one moves into regions where the current level changes more extremely from one segment to the next. As we bring wires of different lengths and diameters into close proximity, the accuracy of the result may suffer. All wires must be above ground.</p>
  <p>Fortunately, NEC-2 contains a self-testing ability that will detect many model inadequacies. The average gain test is a necessary but not sufficient test of adequacy, and there are some inadequate models that the test will not detect. Although the convergence test is applicable to NEC models, it is the most used test for determining the adequacy of MININEC models. (Antenna Model incorporates the average gain test into its implementation of MININEC.) Hence, modelers who use NEC have a way to determine to a high, although incomplete, degree of confidence the quality of their models.</p>
  <p>NEC-4 represents a further development of and revision to NEC-2. The current calculations use a different algorithm that gives higher accuracy to antenna structures that use a tapering diameter. However, for very steep tapers, the results do not fully mesh with MININEC or Leeson correction results. Since the new algorithms treat only axial currents, some of the same limitations affecting NEC-2 still apply, although in some cases, to a lesser degree. For further details, see "NEC-4.1: Limitations of Importance to Hams," <i>QEX</i> (May/June, 1998), pp. 3-16.</p>
  <p>However, NEC-4 adds a considerable number of new features that enhance modeling. The core permits wires below ground for accurate modeling of ground radial systems and similar subterranean structures. The core allows the modeler to specify insulating sheaths for wires. Besides the near-field analysis available in NEC-2, NEC-4 also uses a second form of near-field analysis along the axis of a line specified by the modeler. Although the standard above ground medium is a vacuum or dry air, NEC-4 allows specification of a different upper medium, with constant supplied by the modeler. The newer core also permits plot data file storage directly rather than via facilities provided by the commercial implementation.</p>
  <p>NEC-4 has another important difference from NEC-2: it is not public domain. Instead, it is proprietary with the Lawrence Livermore National Laboratory and the University of California. It requires a separate license before a commercial implementation (GNEC or EZNEC Pro/4) can be sold. In recent years the cost of a license to an individual--such as a radio amateur--for non-commercial purposes has come way down, but may still be significant in deciding whether to invest in a NEC-4 package. You may obtain the license materials on line at <b>LLNL</b></p>
  <p>For many applications, there are "work-arounds" available so that NEC-2 results will reasonably replicate what you would obtain using NEC-4. However, for many other types of applications, NEC-4 is necessary. For example, simulating a buried radial system for a vertical monopole was once believed to be possible using either a MININEC-type ground (available in EZNEC) or a system of radials placed very close to the ground. Subsequent modeling in NEC-4 using buried wires has shown some serious shortcomings of the NEC-2 work-arounds. Hence, for critical applications, NEC-4 is the core of choice, if available.</p>
  <p>Throughout these initial descriptions of both NEC and MININEC, I have referred to "round-wire" modeling. Both cores use algorithms based on the thin round wires, normally in a vacuum or dry air and well separated from other materials. A considerable amount of current antenna design uses elements with other cross-section geometries and other environments. For example, laying (or etching) copper strips on a substrate is a common construction method for antennas in the UHF region and upward. Without extensive external calculations of the adjustment for the changed geometry and the substrate, NEC cannot accurately model such structures. Those structures require the use of what some call hybrid programs that combine method-of-moments techniques with other means of accounting for altered current distribution and the influence of the base material. For even the well-heeled amateur interested in modeling, the cost of such programs--virtually all of which are proprietary--can be daunting, if not downright forbidding.</p>
  <h4>4. Segment Limitations</h4>Thus far, we have been looking primarily at differences among the calculation cores available for round-wire antenna modeling. The major implementation-specific differences that we have explored are the file formats for storing antenna models. However, among the commercial implementations of NEC, there is another more fundamental limitation: the number of segments permitted by the core. The procedure--from a programming perspective--for setting the maximum number of segments allowed is straightforward. Therefore, some commercial versions of NEC have segments limits below the maximum possible values.
  <p>The most notable of programs with segment limitations is EZNEC, now in version 4. Regular EZNEC limits the number of segments to 500, while EZNEC Plus allows 1500. EZNEC Pro (in both NEC-2 and NEC-4 versions), allows up to 20,000 segments by controlling the utilization of virtual memory. An allied decision made by commercial implementations of NEC is whether to use a single-precision or double precision core. Single precision cores run faster, although double-precision results are normally more precise. The speed difference does not show up in small models, while the precision difference does not appear until a model becomes highly complex.</p>
  <p>NEC2GO claims its NEC-2 core has no segment limitation. In contrast, the NEC-2D (meaning double precision) core in both NEC-Win Plus and NEC-Win Pro set the limit at 10,000 segments. GNEC's NEC-4D core allows up to a little over 11,000 segments, since it does not internally control the use of virtual memory during a run. In addition, cores may automatically set their dimensions, including the allowable number of segments, memory, and wires to a junction, by programming pre-sets, or by manual user settings. EZNEC sets the segmentation limits and memory allocation automatically by virtue of the model size, and NEC-Win Plus uses a similar system. However, NEC-Win Pro and GNEC have a parameter file to allow the user to set values for the most efficient core operation.</p>
  <p>When new to antenna modeling, 500 segments may seem to be enough for the biggest imaginable problem. However, it is wise to consider both present and future uses of a modeling program before opting for the least expensive and most segment-limited version. Of course, economics may prove to be a decisive factor in decision-making, in which case, one may have to obtain simply the best program for the price. If you can take future potential modeling activities into account, the following brief examples may be of interest.</p>
  <ul>
    <li>1. Adhering to appropriate modeling guidelines for either NEC or MININEC, a 5-band quad may require as many as 220 segments per set of loops for each band.</li>
    <li>2. A 5 wavelength, 3-wire rhombic may require up to 600 segments.</li>
    <li>3. A 160-meter 4-square array with a full buried radial system with 32-radials per monopole may require nearly 1600 segments.</li>
    <li>4. A VHF or UHF corner reflector of considerable size and composed of a wire-grid structure may require over 2200 segments.</li>
  </ul>
  <p>How large your models might someday become as you refine your modeling efforts presents you with some interesting match-ups with available software.</p>
  <p>I began these notes with the vain hope of compressing the options facing the potential antenna modeler into a single session. However, that goal is not realistic, so we shall have to spend one more episode on the subject. With the transition into options involving the number of available segments, we are moving from general considerations of the NEC and MININEC cores into choices among the features and facilities offered by the available implementations. We shall continue in this vein next time.</p>
  <p>Also see the <a href="../model/nec.html">Antenna Modeling Programs</a> page for more information.</p>
  <center>
    <img src="../images/colorbar.gif" width="591" height="3">
  </center>
  <p><i>Updated 01-12-2006. &COPY; L. B. Cebik, W4RNL. This item first appeared in</i> QEX<i>, Sep/Oct, 2005, pp. 54-59. Reproduced with permission. Copyright ARRL (2005), all rights reserved. This material originally appeared in</i> QEX: Forum for Communications Experimenters <i>(<a href="https://www.arrl.org/qex" target="_blank">www.arrl.org/qex</a>).</i></p>
  <center>
    <img src="../images/colorbar.gif" width="591" height="3">
  </center>
  <p><a href="ao.html"><img src="../images/return.gif" align="bottom" width="40" height="40"> Return to series index page</a></p>
  <p class="topics-footer">Topics: <a href='../topics.html#modeling'>Modeling</a></p><br>
</body>
</html>
