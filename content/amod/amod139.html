<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Antenna Matching with EZNEC Version 5</title>
  <link rel="stylesheet" href="../styles.css">
</head>
<body>
  <center>
    <h1>Antenna Matching with EZNEC Version 5<br>
    Part 1. Transformers and Shunt Loads</h1>
  </center>
  <center>
    <h3>L. B. Cebik, W4RNL</h3>
  </center>
  One of the most popular implementations of NEC, EZNEC, introduced in May, 2007, a new version (5) with a number of facilities that may be new to NEC users. The features include the ability to place loads in parallel to wire segments, the creation of ideal transformers, and the implementation of L-networks that use values of inductance and capacitance (or resistance and reactance). From the last item, we can create more complex networks by joining L-networks in series. A number of other implementations have facilities for calculating some of these items, but normally as adjuncts to the program. In EZNEC, the facilities are part of the input interface and therefore enter the core calculations. Moreover, the facilities are frequency nimble. For example, entering a shunt capacitor or inductor across the source wire of a model will produce correct results over a wide frequency span as an integral part of the model. In contrast, resistance-reactance loads or of Y-parameter networks insert constant values that apply only to a given frequency. As a consequence of pre-calculations in the interface, EZNEC output facilities, such as the total model sweep or the more limited SWR sweep will provide (within limits) accurate data for each frequency within the sweep.
  <p>Newer modelers may be unaccustomed to using such facilities. Therefore, in this episode and the next, we shall look at some examples of modeling with these facilities. This session will examine ideal transformers and shunt component loads. The next will look at the use of L-networks in 2-element configurations and in combination to produce 3-element networks.</p>
  <p><b>A Simple Short Loaded Dipole and an Ideal Transformer</b></p>
  <p>The process of using simple series-connected loads--the norm for the NEC cores--is familiar to virtually all modelers. Suppose that we begin with a center-fed dipole that is only 1/4 wavelength (and composed of AWG #12 copper wire for this sample). The feedpoint impedance will produce a free-space impedance of about 15 - j840 Ohms at a test frequency of 14.175 MHz. One way to bring the antenna to resonance is to insert a center-loading inductor. For this and ensuing examples, we shall assume a realistic Q of 200 for inductors. An inductor in series with the source, that is, a center-loading coil) will need about 9.44 uH. <b>Fig. 1</b> shows the outline of the simple antenna, along with wire and load tables for the model. Because we wish the model to provide accurate performance reports across the entire amateur 20-meter band, we have used an RLC network rather than a frequency-specific R-X network.</p>
  <center>
    <img src="amod139-1.gif" border="2" height="511" hspace="9" vspace="5" width="721">
  </center>
  <p>The 2.8-Ohm series resistance in the center-loading coil reduces antenna gain (without changing the basic shape of the free-space pattern). Of course, the shorter wire length (relative to a full 1/2 wavelength dipole) also contributes to showing a gain of 0.88 dBi rather than the 2+ dBi value that we expect of dipoles. However, as shown in <b>Table 1</b>, the antenna is now self-resonant within about +/-j1 Ohm. For reference, the table shows the 15-Ohm SWR values at the lower and upper ends of the operating passband, along with the power efficiency of the antenna, taking into account both the material loss of the copper wire (very small) and the losses in the center inductor (sizable).</p>
  <center>
    <img src="amod139-t1.gif" border="2" height="140" hspace="9" vspace="5" width="420">
  </center>
  <p>The remaining operational difficulty with the antenna is the very low impedance. One way to bring the impedance closer to the standard coaxial cable and amateur equipment value of 50 Ohms is to insert a transformer of some sort between the existing feedpoint (ostensibly at the center of a split loading coil) and the feedline. In practice, we might wind a conventional transformer (with either an air or a powdered iron core) or a transmission-line transformer. We can simulate an ideal transformer within the program by entering the line shown in <b>Fig. 2</b>.</p>
  <center>
    <img src="amod139-2.gif" border="2" height="340" hspace="9" vspace="5" width="586">
  </center>
  <p>The view of the antenna shows two squares at the feedpoint. One represents the normal series inductive load. The second, with an X at its center, represents the ideal transformer that appears in parallel with the source (with the load inductor in series with both the source and the transformer port). The second port of the transformer would normally go to a remote wire to serve as the new source wire. Ordinarily, we construct such wires at very large distances from the main antenna geometry, and we make them very short and thin. The goal is to avoid interactions with the main antenna element (or elements) that might change the performance reports. In version 5 of EZNEC, the program can create these remote wires as virtual wires that need not show up in either the wire table or the view of the antenna. Instead, the view indicates the existence of the virtual wire, but does not shrink the size of the antenna element in an effort to show both the source wire and the main element.</p>
  <p>Note that the specification of the transformer requires that we attend to both the port connections and the values. For highest accuracy, the relative impedance values should be close to the desired values (and not be simply arbitrary values that yield the same ratio of impedances). For the sample, I have used the approximate raw element impedance (15 Ohms) at Port 1, which connects to the element wire segment that used to be the source. Port 2 lists the desired impedance value and connects to the virtual wire to which the model has also assigned the source. In the sample, I have used the desired values, even though the impedance ratio is 1 to 3.33. In practice, one might have used 60 Ohms for Port 2 in order to simulate a 1:4 transmission-line transformer.</p>
  <p>One reason for referring to the transformer input and output terminals as ports is that the program creates for the core a network (or its equivalent) that follows the general rules described in episode 127 of this series. The program therefore follows Y-parameter port designations, even though the input values are impedance values rather than admittance values. It does not matter which port serves as the source and which as the load so long as the modeler associates the correct impedance value with the correct connection to the model's geometry.</p>
  <center>
    <img src="amod139-3.gif" border="2" height="229" hspace="9" vspace="5" width="432">
  </center>
  <p>We can see the ideality of the transformer in <b>Fig. 3</b>, a dual SWR sweep of the model before and after the addition of the transformer. One line is the 50-Ohm SWR at the source with the transformer in place; the other line is the 15-Ohm SWR before the addition of the transformer. One of the lines is invisible, because the other lines overlays it with graphical perfection. Similar data appears in the SWR values at the band edges in <b>Table 1</b>. The line tracking of the sweeps provides evidence that the transformer is (within limits) frequency nimble and yields correct results for what is essentially a lossless component. As constituted at present, there is no practical way to introduce losses into the transformer facility. Its existence in the model yields only a 0.1% change in the model's reported power efficiency.</p>
  <p><b>Matching a Resonant 3-Element Yagi</b></p>
  <p>Let's change examples and review a broader spectrum of matching possibilities. As shown in <b>Fig. 4</b>, we shall now use a 3-element Yagi for 28.5 MHz, with the elements consisting of 1/2"-diameter aluminum. The antenna is full size and the driver is set to resonance, about 25.7 Ohms. Once more, the environment is free space, and the E-plane pattern shows the generally high performance potential of the design.</p>
  <center>
    <img src="amod139-4.gif" border="2" height="410" hspace="9" vspace="5" width="690">
  </center>
  <p>With the listed feedpoint impedance of the parasitic array, we generally have two major avenues of conveniently matching the source to a 50-Ohm feedline. One method is to create a 37-Ohm 1/4 wavelength section of transmission line from the present source segment to a remote model wire that becomes the new source segment. Although 35-Ohm coaxial cables do exist, the more common amateur practice is to place two length of 70-75-Ohm line in parallel to create the desired line. A second method is to employ a 1:2 impedance transformer between old source segment and the new one. <b>Fig. 5</b> outlines the options in schematic form.</p>
  <center>
    <img src="amod139-5.gif" border="2" height="250" hspace="9" vspace="5" width="350">
  </center>
  <p>We may implement either matching system within the modeling facilities of EZNEC, V5, using in one case the transmission-line facility and in the other case the ideal transformer facility. In both cases, the source segment moves to the new virtual wire that is part of each model. <b>Fig. 6</b> shows a close-up view of the driver element to record the designations for the transformer (X) and the transmission line (T) in the views of the antenna.</p>
  <center>
    <img src="amod139-6.gif" border="2" height="482" hspace="9" vspace="5" width="828">
  </center>
  <p>The transformer version of the model follows the exact pattern that we selected for the dipole, with changes in segment numbers and impedance values to reflect the new situation. The transmission-line entry may seem a bit odd to those who are only used to working with the lossless lines of NEC itself. The program has instituted a method of accounting for approximate transmission-line losses by allowing the user to enter a loss value and a frequency. Such values are readily available from charts, such as the one on page 24-19 of <i>The ARRL Antenna Book</i>. The values in the sample entry are for a version of RG-59, a 70-Ohm cable that most amateur might use in a parallel arrangement to effect the 1/4 wavelength line. The listed physical length divided by the listed velocity factor would yield an electrical quarter wavelength.</p>
  <center>
    <img src="amod139-t2.gif" border="2" height="370" hspace="9" vspace="5" width="495">
  </center>
  <p><b>Table 2</b> shows the reported results of our variations in the methods of matching the 25-Ohm element impedance to a coaxial feedline. The table begins with data for the model with no matching systems. The second section uses three versions of the 1/4 wavelength matching section composed of transmission line. If we do not assign losses to the transmission line, the gain and front-to-back values remain the same as in the pre-matched model. The following two entries note the loss values that we may glean from tables for RG-11 (a half-inch cable) and RG-59 (a thinner cable). Note that the matching line losses do make a difference to the reported gain value (without altering the front-to-back value). However, losses are below the level of being operationally detectable, and the SWR limiting values have not changed by any amount that we could detect in normal testing. Since the 1/4 wavelength transformer is also part of the linear run of feedline cable, the net loss is simply the difference between the matching section loss and an equivalent length of main feedline cable.</p>
  <p>The bottom of the table shows the results from inserting an ideal transformer into the model. As both the gain and the efficiency values show, the ideal transformer leaves the basic values virtually unchanged. A real transformer of conventional design might introduce perhaps 2-3% losses. Such losses would bring the efficiency down to the level of the 1/4 wavelength transmission-line transformation system, with gain values that are likely to reflect those values. However, our goal is not to weigh the merits of specific implementations of a matching system. Rather, the goal has been to show the modeling facilities involved in both methods of matching.</p>
  <p><b>Matching a Non-Resonant 3-Element Yagi</b></p>
  <p>To advance our progression through the matching options offered as frequency-nimble facilities in EZNEC, V5, let's make a small alteration in the 3-element 28.5-MHz Yagi composed on 1/2"-diameter aluminum elements. Element spacing will be unchanged, as will the lengths of the director and reflector. However, we shall shorten the driver so that it shows an impedance of about 24 - j24 Ohms. <b>Fig. 7</b> shows the general outline of the array, along with the free-space E-plane pattern. These graphics would not reveal the model changes. Hence, the figure also includes the wire table for comparison with the table in <b>Fig. 4</b>. The total driver length change is just about 0.4' or 4.75". The change makes virtually no difference to the beam's performance with respect to gain or the front-to-back ratio.</p>
  <center>
    <img src="amod139-7.gif" border="2" height="410" hspace="9" vspace="5" width="690">
  </center>
  <p>The driver impedance conditions ripen the array for matching to a 50-Ohm cable via a beta or hairpin matching system. A beta match is simply an L-network in which the series load-side reactance is contained in the element impedance. Since the element series reactance is capacitive, the source-side shunt reactance must be inductive. We connect the shunt component directly across the feedpoint terminals, essentially in parallel with the source. In practice, we usually find one of three types of shunt components to create the required reactance. <b>Fig. 8</b> shows the general options for our beam.</p>
  <center>
    <img src="amod139-8.gif" border="2" height="270" hspace="9" vspace="5" width="350">
  </center>
  <p>Essentially, two of the three options boil down to one: a shorted transmission-line stub. The stub length depends on the required reactance, about j48 Ohms in the present case. It also depends upon the characteristic impedance (Zo) of the transmission line used to create the reactance: the higher the value of Zo, the shorter the line to achieve the reactance.</p>
  <p>The transmission-line facility of NEC is ideal for implementing a shunt inductive reactance across the feedpoint, since transmission-lines (as special forms of networks) appear in parallel with sources. EZNEC has long used a remote, invisible wire to effect transmission line opens and shorts, so the modeler need not create a special terminating wire for such lines. The latest version of the program adds the ability to calculate the losses of such lines when used as stubs (or in any other application). <b>Fig. 9</b> shows two different stubs. One uses a 600-Ohm line, which would normally employ parallel transmission line--often homemade. From such lines, the label "hairpin" match emerged. The sample version uses the 10-MHz loss factor for 600-Ohm ladder line to estimate losses that the stub might introduce into the model.</p>
  <center>
    <img src="amod139-9.gif" border="2" height="277" hspace="9" vspace="5" width="828">
  </center>
  <p>As an alternative to the 600-Ohm hairpin stub, we might also employ a length of common 50-Ohm cable to create the shorted stub. The impedance is less than 1/10 the impedance of the hairpin line, but the length is a little under 10 times longer. The difference appears because the reactance of a shorted stub is not a linear function of length, but a tangent function of the line length in electrical degrees (or radians). Despite the differences of appearance, both versions of the beta stub perform the same function with equal success.</p>
  <p>The third option is a shunt inductor, which by some convoluted logic received a bygone label of "hairpin inductor." Our problem with the shunt inductor (where an inductance of about 0.27 uH provides the required j48 Ohms at 28.5 MHz) lies in trying to create a model that includes it. In the past, we have needed to develop a physical structure composed of very short wires around an equally short source segment. Then we could add the inductive load to one of the wires in the box as a standard series connected load. To create a structure that provides the least effect on beam performance, we then had to use very short segments throughout the model, resulting in a sizable model (in terms of segment count) for a fairly simple beam. <b>Fig. 10</b> shows such a model that uses 2" segments, which is approaching the limit for wires having a radius of 0.25". Indeed, the outline does not show entire elements due to space restrictions. However, the wire table shows the degree to which the initial model has grown. Despite its limitations, the work-around has been useful.</p>
  <center>
    <img src="amod139-10.gif" border="2" height="450" hspace="9" vspace="5" width="690">
  </center>
  <p>The latest version of EZNEC puts the work-around out to pasture by allowing the user to create any of the standard loads (plus the EZNEC trap load) and to then place them either in series with or in parallel to sources or transmission lines on the same segment. <b>Fig. 11</b> shows the simple 1-line Load entry that uses an inductor with a Q of 200. The load configuration (that is, the relationship of the load R-L-C or R-X elements) is a series arrangement, as is appropriate to the resistance and inductance in a coil. However, rather than the default series connection with the wire segment, the entry specifies a parallel connection. The antenna viewing feature differentiates load boxes by using squares for series-connected loads and diamonds for shunt or parallel-connected loads, as indicated in the upper right corner of the graphic.</p>
  <p>The first question is whether the arrangement works. <b>Table 3</b> provides the results for the series of models illustrated in these notes, beginning with the pre-match model of the antenna. The pre-match SWR values emerge from a sweep that used a series inductor to allow the resistive portion of the feedpoint impedance to serve as the SWR reference.</p>
  <center>
    <img src="amod139-11.gif" border="2" height="220" hspace="9" vspace="5" width="721">
  </center>
  <p>The second portion of the table shows the results of using models of shorted transmission-line stubs as the beta shunt component. For both hairpin and coaxial components, the table lists no-loss versions of the line as well as versions with loss factors derived from various tables. In principle, RG-58 results in a numerically noticeable loss that is greater than any other beta shunt. However, the total gain reduction is about 0.15-dB relative to a lossless situation, a level that one would be hard-pressed to measure under the best of circumstances.</p>
  <p>The final part of the table begins with the reported values from the all-wire bridge construction, which happen to extend so that its broadside is in the plane of the elements. The gain value seems to be numerically high, and it is. The AGT for the model is 1.011, indicating an overestimate of gain of about 0.05 dB. The remaining 0.4-dB is a function of the bridge wires themselves. Of course, once we add in the inductor losses from having a finite Q (200), the gain value comes down and disguises the result.</p>
  <p>We obtain a clearer picture of the effects of inductor losses by using the parallel connected inductive load. With no losses, the gain returns to the value shown by the pre-match version of the mode. Adding in the loss reduces the gain by only 0.02 dB, a reduction that is less than the better of the two coaxial cable shorted stubs. Once upon a time, some amateur texts claimed a wider operating bandwidth for beta inductors over hairpins due to the inductor's lower Q and higher losses. The small exercise shows that the losses, even with a Q as low as 200, rival those of the 600-Ohm hairpin. The difference in band-edge SWR values is largely a function of the different rates of reactance change for transmission-line stubs and inductors across a span of frequencies.</p>
  <center>
    <img src="amod139-t3.gif" border="2" height="580" hspace="9" vspace="5" width="495">
  </center>
  <p>We might briefly glimpse at part of the means by which EZNEC, V5, achieves frequency-nimble parallel-connected loads. The interface calculates a Y-parameter network at each frequency before supplying the data to the core for its run at each frequency within a sweep. EZNEC Pro/4 allows us to save .NEC format model files for each frequency. The models are identical except for the NT command that is unique to each frequency. <b>Table 4</b> shows the NT lines for the parallel inductor in the sample model. After the two port location entry pairs, we find the Y-parameter equivalents of the inductive load for the specified frequency. The EZNEC interface calculates these values and supplies them to the core in the form applicable to its implementation of the NEC-2 and NEC-4 cores. (Data transfer to the core for its run may differ between core types.) The table suffices to show that by moving the calculation to the input interface portion of the program, it can achieve frequency-nimble and accurate results within the limits of each type of facility that it offers.</p>
  <center>
    <img src="amod139-t4.gif" border="2" height="114" hspace="9" vspace="5" width="350">
  </center>
  <p><b>To Be Continued</b></p>
  <p>We have examined only some of the facilities offered by the new version of EZNEC. The program also offers at all levels access to L-networks, from which we can construct networks with from 2 to N components. We shall see how to model a few of the options in our next episode.</p>
  <p><a href="modeling.html"><img src="../images/return.gif" align="bottom" height="40" width="40"> <b>Go to Main Index</b></a></p>
</body>
</html>
